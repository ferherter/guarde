<!doctype html>
<html lang="es">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Liquidación mensual</title>
<style>
  body{font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; max-width: 900px; margin: 24px auto; padding: 0 16px;}
  header{display:flex; align-items:center; gap:12px; margin-bottom:16px}
  h1{font-size: 1.4rem; margin: 0}
  button{padding:10px 14px; border-radius:10px; border:1px solid #ddd; cursor:pointer}
  #out{margin-top:16px; border:1px solid #ddd; border-radius:12px; padding:16px; min-height:120px}
</style>
<body>
<header>
  <h1>Liquidación mensual — comedor</h1>
</header>

<div>
  <label>Mes base:
    <input type="month" id="mes">
  </label>
  <button id="ver">Ver liquidación</button>
</div>

<div id="out">Selecciona un mes y pulsa “Ver liquidación”.</div>

<script>
const API_BASE = "https://script.google.com/macros/s/AKfycbxpVfTIt6FzpEuUvhBZUkq6cV0CvaBxgPyd_HNYgnyPGetS4zHEXxKm7v1Jv3WhLm7vtA/exec";

function defaultMonth(){
  const d=new Date();
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
}
function monthToDate(m){ // "2025-09" -> "2025-09-01"
  const [y,mm]=m.split('-'); return `${y}-${mm}-01`;
}

document.addEventListener('DOMContentLoaded', ()=>{
  document.querySelector('#mes').value = defaultMonth();
  document.querySelector('#ver').addEventListener('click', async ()=>{
    const base = monthToDate(document.querySelector('#mes').value);
    const r = await fetch(`${API_BASE}?tipo=liquidacion&fecha=${base}`, {cache:"no-store"});
    const html = await r.text();
    document.querySelector('#out').innerHTML = html;
  });
});
</script>
</body>
</html>
